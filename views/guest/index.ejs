<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="Panagea - Premium site template for travel agencies, hotels and restaurant listing."
    />
    <meta name="author" content="Ansonika" />
    <title>Panagea</title>

    <!-- Favicons-->
    <link rel="shortcut icon" href="img/favicon.ico" type="/image/x-icon" />
    <link
      rel="apple-touch-icon"
      type="image/x-icon"
      href="/img/apple-touch-icon-57x57-precomposed.png"
    />
    <link
      rel="apple-touch-icon"
      type="image/x-icon"
      sizes="72x72"
      href="/img/apple-touch-icon-72x72-precomposed.png"
    />
    <link
      rel="apple-touch-icon"
      type="image/x-icon"
      sizes="114x114"
      href="/img/apple-touch-icon-114x114-precomposed.png"
    />
    <link
      rel="apple-touch-icon"
      type="image/x-icon"
      sizes="144x144"
      href="/img/apple-touch-icon-144x144-precomposed.png"
    />

    <!-- GOOGLE WEB FONT -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- BASE CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/css/style.css" rel="stylesheet" />
    <link href="/css/vendors.css" rel="stylesheet" />
    <% if(url[1] == 'event' || url[1] == 'event-post' ) {%>
    <!-- SPECIFIC CSS -->
    <link href="css/blog.css" rel="stylesheet" />
    <%}%>

    <script src="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.js"></script>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css"
      rel="stylesheet"
    />

    <!-- YOUR CUSTOM CSS -->
    <link href="/css/custom.css" rel="stylesheet" />
    <base href="https://projecyundergraduate.herokuapp.com/" />
    
  </head>

  <body class="datepicker_mobile_full">
    <!-- Remove this class to disable datepicker full on mobile -->

    <div id="page">
      <header class="header menu_fixed">
        <div id="preloader">
          <div data-loader="circle-side"></div>
        </div>
        <!-- /Page Preload -->
        <div id="logo">
          <a href="home">
            <img
              src="/img/logo.png"
              width="150"
              height="36"
              alt=""
              class="logo_normal"
            />
          </a>
        </div>
        <ul id="top_menu">
          <li>
            <a href="#sign-in-dialog" id="sign-in" class="login" title="Sign In"
              >Sign In</a
            >
          </li>
          <li>
            <div class="dropdown" style="display: none" id="user">
              <input
                type="button"
                class="btn btn-secondary dropdown-toggle"
                type="button"
                id="dropdownMenuButton"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                value=""
              />
              <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <input
                  type="button"
                  class="dropdown-item"
                  id="logout"
                  value="Logout"
                />
              </div>
            </div>
          </li>
          <li>
            <%if(user == null){%>
            <a
              href="wishlist"
              id="listwish"
              class="wishlist_bt_top"
              title="Your wishlist"
              style="display:none"
              >Your wishlist</a
            >

            <%} else{%>
            <a
              href="wishlist"
              id="listwish"
              class="wishlist_bt_top"
              title="Your wishlist"
              >Your wishlist</a
            >
            <%}%>
          </li>
        </ul>
        <!-- /top_menu -->
        <a href="#menu" class="btn_mobile">
          <div class="hamburger hamburger--spin" id="hamburger">
            <div class="hamburger-box">
              <div class="hamburger-inner"></div>
            </div>
          </div>
        </a>
        <nav id="menu" class="main-menu">
          <ul>
            <li>
              <span><a href="home">Home</a></span>
            </li>

            <li>
              <span><a href="property/1">Properties</a></span>

              <ul>
                <%if(url[1] == 'details'){%>
                  <%menu.forEach(e=>{%>
                    <li><a href="<%=e.name%>/1"><%=e.name%></a></li>
                    <%})%>
                <%}else{%>
                  <%data.forEach(e=>{%>
                    <li><a href="<%=e.name%>/1"><%=e.name%></a></li>
                    <%})%>
                <%}%>
               
              </ul>
            </li>
            <%if(user == null){%>
              <li>
                <span><a href="history" style="display: none;">Cart History</a></span>
              </li>
           <%}else{%>
            <li>
              <span><a href="history" >Cart History</a></span>
            </li>
          <%}%>
           
          </ul>
        </nav>
      </header>
      <!-- /header -->

      <%-include(main);%>
      <!-- /main -->

      <footer>
        <div class="container margin_60_35">
          <div class="row">
            <div class="col-lg-5 col-md-12 p-r-5">
              <p><img src="/img/logo.svg" width="150" height="36" alt="" /></p>
              <p>
                Mea nibh meis philosophia eu. Duis legimus efficiantur ea sea.
                Id placerat tacimates definitionem sea, prima quidam vim no. Duo
                nobis persecuti cu. Nihil facilisi indoctum an vix, ut delectus
                expetendis vis.
              </p>
              <div class="follow_us">
                <ul>
                  <li>Follow us</li>
                  <li>
                    <a href="#0"><i class="ti-facebook"></i></a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-6 ml-lg-auto">
              <h5>Useful links</h5>
              <ul class="links">
                <li><a href="about">About</a></li>
                <li><a href="login">Login</a></li>
                <li><a href="register">Register</a></li>
                <li><a href="feedback">Feedback</a></li>
              </ul>
            </div>
            <div class="col-lg-3 col-md-6">
              <h5>Contact with Us</h5>
              <ul class="contacts">
                <li>
                  <a href="tel://61280932400"
                    ><i class="ti-mobile"></i> + 61 23 8093 3400</a
                  >
                </li>
                <li>
                  <a href="mailto:info@Panagea.com"
                    ><i class="ti-email"></i> info@Panagea.com</a
                  >
                </li>
              </ul>
              <div id="newsletter">
                <h6>Newsletter</h6>
                <div id="message-newsletter"></div>
                <form
                  method="post"
                  action="assets/newsletter.php"
                  name="newsletter_form"
                  id="newsletter_form"
                >
                  <div class="form-group">
                    <input
                      type="email"
                      name="email_newsletter"
                      id="email_newsletter"
                      class="form-control"
                      placeholder="Your email"
                    />
                    <input
                      type="submit"
                      value="Submit"
                      id="submit-newsletter"
                    />
                  </div>
                </form>
              </div>
            </div>
          </div>
          <!--/row-->
          <hr />
          <div class="row">
            <div class="col-lg-12">
              <ul id="additional_links">
                <li><a href="#0">Terms and conditions</a></li>
                <li><a href="#0">Privacy</a></li>
                <li><span>© 2021 Panagea</span></li>
              </ul>
            </div>
          </div>
        </div>
      </footer>
      <!--/footer-->
    </div>
    <!-- page -->

    <!-- Sign In Popup -->
    <div id="sign-in-dialog" class="zoom-anim-dialog mfp-hide">
      <div class="small-dialog-header">
        <h3>Sign In</h3>
      </div>
      <form action="" method="POST" id="login_form">
        <div class="sign-in-wrapper">
          <a href="" id="btn_google" class="social_bt google"
            >Login with Google</a
          >
          <div class="divider"><span>Or</span></div>
          <div class="form-group">
            <label>Email</label>
            <input type="email" class="form-control" name="email" id="email" />
            <i class="icon_mail_alt"></i>
          </div>
          <div class="form-group">
            <label>Password</label>
            <input
              type="password"
              class="form-control"
              name="password"
              id="password"
              value=""
            />
            <i class="icon_lock_alt"></i>
          </div>
          <div class="clearfix add_bottom_15">
            <div class="checkboxes float-left">
              <label class="container_check"
                >Remember me
                <input type="checkbox" />
                <span class="checkmark"></span>
              </label>
            </div>
            <div class="float-right mt-1">
              <a id="forgot" href="javascript:void(0);">Forgot Password?</a>
            </div>
          </div>
          <div class="text-center">
            <input type="submit" value="Log In" class="btn_1 full-width" />
          </div>
          <div class="text-center">
            Don’t have an account? <a href="register">Sign up</a>
          </div>
       
        </div>
      </form>
      <form action="" method="POST" id="forgot_form">
        <div id="forgot_pw">
            <div class="form-group">
              <label>Please confirm login email below</label>
              <input
                type="email"
                class="form-control"
                name="email_forgot"
                id="email_forgot"
              />
              <i class="icon_mail_alt"></i>
            </div>
            <p>
              You will receive an email containing a link allowing you to reset
              your password to a new preferred one.
            </p>
            <div class="text-center">
              <input type="submit" value="Reset Password" class="btn_1" />
            </div>
          </div>
    </form>
      <!--form -->
    </div>
    <!-- /Sign In Popup -->

    <div id="toTop"></div>
    <!-- Back to top button -->
    <!-- COMMON SCRIPTS -->
    <script src="/js/common_scripts.js"></script>
    <script src="/js/main.js"></script>
    <script src="/assets/validate.js"></script>
    <script>
      $(window).on("load", function () {
        if (localStorage.getItem("propertyGlobal") === null) {
          $("#sign-in").show();
          $("#user").hide();
        } else {
          var user = JSON.parse(localStorage.getItem("propertyGlobal"));
          $("#sign-in").hide();
          $("#user").show();
          $("#dropdownMenuButton").val(user[0].name);
        }
      });

      $(document).ready(function () {
        $("#login_form").on("submit", function (e) {
          e.preventDefault();
          // khai báo
          var password, email, iduser;
          // lấy dữ liệu
          password = $("#password").val();
          email = $("#email").val();

          // iduser=$('#iduser').val();
          // // gửi ajax
          $.ajax({
            url: "api/processLogin",
            type: "POST",
            data: {
              password: password,
              email: email,
            },
            success: function (result) {
              if (result.kq == 1) {
                propertyGlobal = [
                  {
                    name: result.name,
                    email: result.email,
                    id: result.id,
                     type: result.type
                  },
                ];
                localStorage.setItem(
                  "propertyGlobal",
                  JSON.stringify(propertyGlobal)
                );
                var user = JSON.parse(localStorage.getItem("propertyGlobal"));
                $("#sign-in").hide();
                $("#user").show();
                $("#dropdownMenuButton").val(user[0].name);
                window.location.reload("back");
              } else {
                alert(result.err);
              }
            },
          });

          return false;
        });
      });
      // LOGIN GOOGLE
      $.ajax({
        url: "api/google/auth",
        type: "POST",
        success: function (result) {
          document
            .getElementById("btn_google")
            .setAttribute("href", result.url_g);
        },
      });
      $(document).ready(function () {
        $("#logout").click(function (e) {
          localStorage.removeItem("propertyGlobal");
          $.post("/logout");
          $("#sign-in").show();
          $("#user").hide();
          window.location.reload("back");
        });
      });
      var url_string = window.location.href;
      if (url_string.indexOf("code") == -1) {
        console.log("Login by system");
      } else {
        var url = new URL(url_string);
        var extract_code = url.searchParams.get("code");
        $.ajax({
          url: "api/google/getUserInfo",
          type: "POST",
          data: {
            code: extract_code,
          },
          success: function (result) {
            propertyGlobal = [
              {
                name: result.data.name,
                email: result.data.email,
                id: result.iduser,
              },
            ];
            localStorage.setItem(
              "propertyGlobal",
              JSON.stringify(propertyGlobal)
            );
            var user = JSON.parse(localStorage.getItem("propertyGlobal"));
            $("#sign-in").hide();
            $("#user").show();
            $("#dropdownMenuButton").val(user[0].name);
            window.location.replace("home");
          },
        });
      }
      //FORGOT_PASSWORD
      $(document).ready(function(){
            $("#forgot_form").on('submit',function(e){
                e.preventDefault()
              
                var email_forgot;
                email_forgot = $('#email_forgot').val()
               
              $.ajax({
                  url:'api/ResetPassword',
                  type: 'POST',
                  data:{
                      'email_forgot':email_forgot
                  },success: function(result) {
                        alert(result)
                       
                    }
              })
            })
        })
    </script>

    <%switch(url[1]){ case 'home' : %>
    <!-- DATEPICKER  -->
    <script>
      $(function () {
        "use strict";
        $('input[name="dates"]').daterangepicker({
          autoUpdateInput: false,
          minDate: new Date(),
          locale: {
            cancelLabel: "Clear",
          },
        });
        $('input[name="dates"]').on(
          "apply.daterangepicker",
          function (ev, picker) {
            $(this).val(
              picker.startDate.format("MM-DD-YY") +
                " > " +
                picker.endDate.format("MM-DD-YY")
            );
          }
        );
        $('input[name="dates"]').on(
          "cancel.daterangepicker",
          function (ev, picker) {
            $(this).val("");
          }
        );
      });
    </script>

    <!-- INPUT QUANTITY  -->
    <script src="/js/input_qty.js"></script>

    <!-- Autocomplete -->
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.min.js"></script>
<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.0/mapbox-gl-geocoder.css" type="text/css">
<!-- Promise polyfill script required to use Mapbox GL Geocoder in IE 11 -->
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>
<script>
	// TO MAKE THE MAP APPEAR YOU MUST
	// ADD YOUR ACCESS TOKEN FROM
	// https://account.mapbox.com
mapboxgl.accessToken = 'pk.eyJ1IjoibW1uaGF0IiwiYSI6ImNra3o5NHdpYTA5ajYyeW55eTc2ejlobnAifQ.qQBw5oTAA0KlC6ctu7j6zg';
var geocoder = new MapboxGeocoder({
accessToken: mapboxgl.accessToken,
mapboxgl: mapboxgl
});
geocoder.addTo('#geocoder');

 
// Add geocoder result to container.
geocoder.on('result', function (e) {
const result =JSON.parse(JSON.stringify(e.result, null, 2)) 

$.ajax({
    url :'property/search',
    type:'POST',
    data:{
      'result':result.place_name
    },
    success:function(result){
      if(result.kq == 1){
        $("#reccomended").html(result.data);
      }
      else{
        alert(result.message)
      }
    }
})
});

 
 
</script>
    <% break; case 'property':%>
    <!-- Map -->

    <script src="/js/map_hotels.js"></script>

    <!-- Masonry Filtering -->
    <script src="/js/isotope.min.js"></script>
    <script>
      $(window).on("load", function () {
        var $container = $(".isotope-wrapper");
        $container.isotope({
          itemSelector: ".isotope-item",
          layoutMode: "masonry",
        });
      });

      $(".filters_listing").on("click", "input", "change", function () {
        var selector = $(this).attr("data-filter");
        $(".isotope-wrapper").isotope({
          filter: selector,
        });
      });
    </script>
   <script>
   
   </script>

    <% break; case 'House':%>
    <!-- Map -->

    <script src="/js/map_hotels.js"></script>

    <!-- Masonry Filtering -->
    <script src="/js/isotope.min.js"></script>
    <script>
      $(window).on("load", function () {
        var $container = $(".isotope-wrapper");
        $container.isotope({
          itemSelector: ".isotope-item",
          layoutMode: "masonry",
        });
      });

      $(".filters_listing").on("click", "input", "change", function () {
        var selector = $(this).attr("data-filter");
        $(".isotope-wrapper").isotope({
          filter: selector,
        });
      });
    </script>
    <% break; case 'Flat':%>
    <!-- Map -->

    <script src="/js/map_hotels.js"></script>

    <!-- Masonry Filtering -->
    <script src="/js/isotope.min.js"></script>
    <script>
      $(window).on("load", function () {
        var $container = $(".isotope-wrapper");
        $container.isotope({
          itemSelector: ".isotope-item",
          layoutMode: "masonry",
        });
      });

      $(".filters_listing").on("click", "input", "change", function () {
        var selector = $(this).attr("data-filter");
        $(".isotope-wrapper").isotope({
          filter: selector,
        });
      });
    </script>
    <% break; case 'Hotel':%>
    <!-- Map -->

    <script src="/js/map_hotels.js"></script>

    <!-- Masonry Filtering -->
    <script src="/js/isotope.min.js"></script>
    <script>
      $(window).on("load", function () {
        var $container = $(".isotope-wrapper");
        $container.isotope({
          itemSelector: ".isotope-item",
          layoutMode: "masonry",
        });
      });

      $(".filters_listing").on("click", "input", "change", function () {
        var selector = $(this).attr("data-filter");
        $(".isotope-wrapper").isotope({
          filter: selector,
        });
      });
    </script>

    <% break; case 'Unique':%>
    <!-- Map -->

    <script src="/js/map_hotels.js"></script>

    <!-- Masonry Filtering -->
    <script src="/js/isotope.min.js"></script>
    <script>
      $(window).on("load", function () {
        var $container = $(".isotope-wrapper");
        $container.isotope({
          itemSelector: ".isotope-item",
          layoutMode: "masonry",
        });
      });

      $(".filters_listing").on("click", "input", "change", function () {
        var selector = $(this).attr("data-filter");
        $(".isotope-wrapper").isotope({
          filter: selector,
        });
      });
    </script>
    <% break; case 'details':%>
    <!-- Map -->
    <script src="/js/map_detail_hotel.js"></script>
    <!-- Wishlist -->
    <script>
      $(document).ready(function () {
        $("#wishlist").click(function (e) {
          var iduser, idproperty;
          iduser = JSON.parse(localStorage.getItem("propertyGlobal"));
          var url = window.location.href;
          idproperty = url.split("/");
          // alert(idproperty[4] + '/' + iduser[0].id)
          if (localStorage.getItem("propertyGlobal") === null) {
            alert("Please Sign in To Use This");
          } else {
            $.ajax({
              url: "api/ProcessWishlist",
              type: "POST",
              data: {
                iduser: iduser[0].id,
                idproperty: idproperty[4],
              },
              success: function (result) {
                if (result.kq == 1) {
                  alert("Add to your wishlist");
                  window.location.reload("back");
                } else {
                  alert(result.err);
                }
              },
            });

            return false;
          }
        });
      });
      $(document).ready(function () {
        $("#remove").click(function (e) {
          var iduser, idproperty;
          iduser = JSON.parse(localStorage.getItem("propertyGlobal"));
          var url = window.location.href;
          idproperty = url.split("/");

          $.ajax({
            url: "api/RemoveWishlist",
            type: "POST",
            data: {
              iduser: iduser[0].id,
              idproperty: idproperty[4],
            },
            success: function (result) {
              if (result.kq == 1) {
                alert("Removed");
                window.location.reload("back");
              } else {
                alert(result.err);
              }
            },
          });

          return false;
        });
      });
     
      $(document).ready(function(){
        $('#booking_form').on('submit',function(e){
          e.preventDefault();
          if (localStorage.getItem("propertyGlobal")== null) {
           window.location.assign('login')
          } else{
          var idproperty,date,adults,children,room,iduser
          var url = window.location.href;
          iduser = JSON.parse(localStorage.getItem("propertyGlobal"));
          date =$('#dates').val();
          adults =$('#adults').val();
          children =$('#children').val();
          room =$('#room').val();
          idproperty = url.split("/");
          $.ajax({
            url: "api/ProcessAddCart",
            type: "POST",
            data: {
              'date':date,
              'iduser':iduser[0].id,
              'adults':adults,
              'children':children,
              'room':room,
              'idproperty': idproperty[4],
            },
            success: function (result) {
             if(result.kq ==1){
               localStorage.setItem("CartID",result.data._id)
               window.location.href ='/checkout'
             }
             else{
               console.log(result.err)
             }
            },
          });

          return false;
          }
      
        })
        })
     
    </script>
    <!-- DATEPICKER  -->
    <script>
      $(function () {
        $('input[name="dates"]').daterangepicker({
          autoUpdateInput: false,
          parentEl: ".scroll-fix",
          minDate: new Date(),
          opens: "left",
          locale: {
            cancelLabel: "Clear",
          },
        });
        $('input[name="dates"]').on(
          "apply.daterangepicker",
          function (ev, picker) {
            $(this).val(
              picker.startDate.format("MM-DD-YY") +
                " > " +
                picker.endDate.format("MM-DD-YY")
            );
          }
        );
        $('input[name="dates"]').on(
          "cancel.daterangepicker",
          function (ev, picker) {
            $(this).val("");
          }
        );
      });
    </script>
    <!-- Review -->
    <script>
      $(document).ready(function () {
        $("#review_form").on("submit", function (e) {
          e.preventDefault();
          if(localStorage.getItem("propertyGlobal") == null){
           window.location.href ='login'
          }else{ // khai báo
          var username, email, rating, text, idproperty;
          var user = JSON.parse(localStorage.getItem("propertyGlobal"));
          // lấy dữ liệu
          var url = window.location.href;
          idproperty = url.split("/");
          username = user[0].name;
          email = user[0].email;
          rating = $("#rating_review").val();
          text = $("#review_text").val();
          // gửi ajax
          $.ajax({
            url: "api/processComment",
            type: "POST",
            data: {
              username: username,
              email: email,
              rating: rating,
              text: text,
              idproperty: idproperty[4],
            },

            success: function (result) {
              if (result.status === 400) {
                throw Error('You already add your review');
               
              } else if(result.status === 500){
                throw Error('Server Error');
              }
              else {
                alert("Review added!");
                window.location.reload("back");
              }
            },
          });

          return false;}
         
        });
      });
    </script>

    <!-- INPUT QUANTITY  -->
    <script src="/js/input_qty.js"></script>
    <script>
      var url = window.location.href;
      var idproperty = url.split("/");
      var id_prop = idproperty[4];
      $.ajax({
        url: "admin/api/property?idproperty=" + id_prop + "",
        type: "GET",
      })
    </script>

    <% break; case 'feedback':%>
    <!-- SPECIFIC SCRIPTS -->
   <script>  
   $(document).ready(function(){
   $("#feedback_form").on("submit",function(e){
     e.preventDefault()
     if(localStorage.getItem("propertyGlobal") == null){
        alert("You have to log-in")
     }else{
       // khai báo
     var name_feedback,feedback
      var user = JSON.parse(localStorage.getItem("propertyGlobal"));
      name_feedback= user[0].name;
      feedback = $("#feedback").val()
    
      $.ajax({
          url: "api/ProcessAddFeedback",
          type: "POST",
          data: {
            'name_feedback': name_feedback,
            'feedback': feedback,
            
          },
          success: function(result) {
          if(result.kq==1){
            alert("We have your feedback!")
            window.location.href = "home"
          }
          }
        })
     }
     
    
 
})
   })
     
</script>
    <% break; 
    case 'checkout':%>
     <!-- STRIPE API PAYMENT -->
  <script src="https://js.stripe.com/v3/"></script>
  <script>   
    $(document).ready(function(){
      var stripe = Stripe('pk_test_51Ig3TKHDgdUfZ7e8cWb6HrW7DhrpXtVfZ6qx36Ml0WO7h84jHDpqS8ofPWGgmKjcwdPz3ja1vg5jTSBXpNpATKGL009Lp839fl')
      $('#checkout').click(function() {
        // khai báo
        var name_card_bookign,email,card_number,expire_month,expire_year,ccv
        var user = JSON.parse(localStorage.getItem("propertyGlobal"));
        name_card_bookign = $("#name_card_bookign").val()
        email = user[0].email;
        card_number = $("#card_number").val()
        expire_month = $("#expire_month").val()
        expire_year = $("#expire_year").val()
        ccv = $("#ccv").val()
        $.ajax({
            url: "api/charge",
            type: "POST",
            data: {
              'name_card_bookign': name_card_bookign,
              'email': email,
              'card_number': card_number,
              'expire_month': expire_month,
              'expire_year':expire_year,
              'ccv': ccv
            },
            success: function(result) {
              if(result.kq == 1)
              window.location.assign('success')
            }
          })
      
      })
})
$(document).ready(function(){
  $("#cancel").click(function(){
    $.post("/cancel");
window.location.href= 'home'
  })
})
</script>
    <% break;
    case 'history':%>
  <script>   
   $(document).ready(function(){
     $("#refund").click(function(e){
       var payment = document.getElementById("payment").getAttribute("payment")
       if (payment == "Visa") {
        var paymentid = document.getElementById("cart_id").getAttribute("payment_id")
     
      $.ajax({
        url:"api/charge_refund",
        type:"POST",
        data: {
          'paymentid':paymentid
        },
        success:function(result){
          if(result.kq==1)
          {
            window.location.href='home'
          }
        }

      })
       } else{
        var paymentid = document.getElementById("cart_id").getAttribute("payment_id")
      //  console.log(paymentid)
      $.ajax({
        url:"api/paypal_refund",
        type:"POST",
        data: {
          'paymentid':paymentid
        },
        success:function(result){
          if(result.kq==1)
          {
            window.location.href='home'
          }
        }

      })
       }
     
     })
   })
 </script>
    <% break;
  }%>
  </body>
</html>
